---
import "../styles/theme.css";
const { title = "موقع الروايات", description = "" } = Astro.props;
---


<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    {description && <meta name="description" content={description} />}

    <!-- Google Fonts (Arabic friendly) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

  <body>
  <header class="topbar" dir="rtl">
  <div class="topbar__inner container">
    <a class="brand" href="/">موقع الروايات</a>

    <nav class="nav">
      <a href="/" class="nav__link">الرئيسية</a>
      <a href="/novels" class="nav__link">كل الروايات</a>
      <a id="accountLink" href="/login" class="nav__link">تسجيل الدخول</a>
    </nav>
  </div>

  <style is:global>
    .topbar{
      position: sticky; top: 0; z-index: 50;
      background: rgba(10,14,22,.7);
      backdrop-filter: blur(6px);
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .topbar__inner{ display:flex; align-items:center; justify-content:space-between; padding:10px 0; }
    .brand{ color:#e9eef5; text-decoration:none; font-weight:700; }
    .nav{ display:flex; gap:14px; }
    .nav__link{ color:#cfd6dd; text-decoration:none; padding:6px 10px; border-radius:10px; }
    .nav__link:hover{ background: rgba(255,255,255,.06); color:#fff; }
  </style>

  <!-- update the Account button text based on auth -->
  <script type="module">
    import { auth } from "@/lib/firebase.js";
    import { onAuthStateChanged, signOut } from "firebase/auth";

    const link = document.getElementById("accountLink");
    onAuthStateChanged(auth, (user) => {
      if (!link) return;
      if (user) {
        link.textContent = "حسابي / تسجيل الخروج";
        link.href = "#";
        link.onclick = async (e) => {
          e.preventDefault();
          await signOut(auth);
          window.location.href = "/"; // back home after logout
        };
      } else {
        link.textContent = "تسجيل الدخول";
        link.href = "/login";
        link.onclick = null;
      }
    });
  </script>
</header>

  <div class="site-bg">
    <slot />
  </div>

  <style is:global>
    /* --- site background: dark + subtle glows + faint noise --- */
    :root{
      --bg-1:#0b0f17;
      --bg-2:#0a0e16;
      --text:#e9eef5;
      --muted:#9aa6b2;
      --glass: rgba(255,255,255,.04);
      --stroke: rgba(255,255,255,.06);
      --radius: 16px;
    }

    html, body, .site-bg { min-height: 100%; }

    body {
      color: var(--text);
      background: #0a0e16;
    }

    .site-bg{
      min-height:100%;
      background:
        radial-gradient(800px 400px at 20% -5%, rgba(160,160,255,.07), transparent 60%),
        radial-gradient(700px 360px at 85% 110%, rgba(255,160,160,.06), transparent 55%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
    }
    /* subtle “noise” */
    .site-bg::after{
      content:"";
      position:fixed; inset:0; pointer-events:none;
      opacity:.045;
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,.8) 0 1px, transparent 1px 2px),
        repeating-linear-gradient(90deg, rgba(255,255,255,.8) 0 1px, transparent 1px 2px);
      filter: blur(.3px);
    }

    /* utilities used below */
    .container{ width:min(1100px, 92vw); margin-inline:auto; }
    .glass{
      background: var(--glass);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      backdrop-filter: blur(4px);
    }
    .btn{ display:inline-block; padding:.65rem 1rem; border-radius:12px; background:#5b7cff; color:#fff; text-decoration:none; }
    .btn:hover{ filter:brightness(1.08) }
    .btn-ghost{ background:transparent; border:1px solid var(--stroke); color:var(--text); }
    .muted{ color: var(--muted); }
  </style>
</body>

</html>
