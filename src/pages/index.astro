---
import Base from "../layouts/Base.astro"; // use relative path; alias "@" may not be configured

// Load chapters for "karih-al-shoujo"
const all = import.meta.glob("/src/content/novels/**/*.md", { eager: true });

type FM = {
  title?: string;
  novel?: string;
  slug?: string;
  chapter?: number;
  summary?: string;
};

const chapters: FM[] = [];
for (const mod of Object.values(all) as any[]) {
  const fm: FM = (mod as any).frontmatter ?? {};
  if (fm.slug === "karih-al-shoujo") chapters.push(fm);
}
chapters.sort((a, b) => (a.chapter ?? 0) - (b.chapter ?? 0));

const novelTitle = chapters[0]?.novel ?? "كاره الشوجو";
---

<Base title="الرئيسية — موقع الروايات" description={`اقرأ ${novelTitle} فصلًا فصلًا بسرعة CDN`}>
  <!-- Hero -->
  <section class="hero hero--karih" dir="rtl">
  <div class="hero__content container glass">
    <h1>مرحبًا بك في عالم الغموض</h1>
    <p class="muted">
      كل شيء ضبابي… حتى الحقيقة. ادخل عالم «كارِه الشوجو» حيث تتقاطع القوى والقدر.
    </p>
    <div class="btn-row">
      <a class="btn" href="/novels/karih-al-shoujo">ابدأ القراءة</a>
      <a class="btn btn-ghost" href="/novels">كل الروايات</a>
    </div>
  </div>

  <style>
    /* hero sizing + background */
    .hero{
      position:relative;
      padding:48px 0;
      min-height: 240px; /* compact on phones */
    }
    .hero--karih{
      /* dim the image with a gradient overlay */
      background:
        linear-gradient(to bottom, rgba(10,14,22,.65), rgba(10,14,22,.35)),
        url("/cover3.png") center right / cover no-repeat;
      border-radius: 0 0 22px 22px;
      overflow: hidden;
    }
    .hero__content{
      padding:20px 22px;
      max-width: 760px;
    }
    .hero__content h1{
      margin: 0 0 .35rem;
      font-size: clamp(1.35rem, 2.5vw + .7rem, 2rem);
      line-height: 1.2;
    }
    .btn-row{ display:flex; gap:.6rem; margin-top:.75rem; flex-wrap:wrap; }

    /* desktop: a bit taller but still sane */
    @media (min-width: 900px){
      .hero{ padding:64px 0; min-height: 320px; }
      .hero__content{ padding:26px; }
    }
  </style>
</section>


  <!-- TOC -->
  <div class="card" style="margin-top:1rem; text-align:center;">
    <img src="/cover3.png" alt="غلاف رواية كاره الشوجو" style="width:100%;border-radius:16px;margin-bottom:1rem;"/>
    <strong style="display:block; font-size:1.2rem; margin-bottom:.4rem;">رواية كاره الشوجو</strong>

    <ol class="toc" id="toc" style="text-align:right; margin:0 auto; max-width:64ch;">
      {chapters.map((c) => (
        <li style="margin:.5rem 0;">
          <a href={`/novels/${c.slug}/${c.chapter}`}>
            الفصل {c.chapter}: {c.title ?? `الفصل ${c.chapter}`}
          </a>
          {c.summary && <span class="muted"> — {c.summary}</span>}
        </li>
      ))}
    </ol>
  </div>
</Base>
